<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>McDonalds SRIW</title>
  <link rel="shortcut icon" href="TemplateData/full.png">
  <link rel="stylesheet" href="TemplateData/style.css">
  <style>
    #accessibility-button {
      pointer-events: auto;
      position: absolute;
      bottom: 5%;
      right: 2.5%;
      height: 10%; /* Based on enclosing div's height */
      aspect-ratio: 1 / 1; 
      cursor: pointer;
      background-color: #000000;
      color: white;
      border: none;
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      transition: background-color 0.3s ease;
    }

    #accessibility-button:hover svg {
      fill: #FFBC0D;
    }

    #accessibility-container {
      pointer-events: none;
      position: absolute;
    }

    #accessibility-button svg {
      position: absolute;
      width: 75%;
      height: 75%;
      top: 12.5%;
      left: 12.5%;
    }

    #accessibility-button svg path {
      fill: white;
      transition: fill 0.3s ease;
    }

    #accessibility-button:hover svg path {
      fill: #FFBC0D;
    }
  </style>
</head>

<body>
  <div id="unity-container">
    <div id="accessibility-container">
      <button id="accessibility-button">
        <svg width="35" height="35" viewBox="0 0 35 35" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_38_32)">
            <path
              d="M17.4999 -5.65968e-06C21.5501 -0.00116341 25.4755 1.40217 28.607 3.97087C31.7386 6.53956 33.8825 10.1147 34.6735 14.0869C35.4645 18.0592 34.8536 22.1829 32.9449 25.7552C31.0362 29.3276 27.9479 32.1275 24.2061 33.678C20.4643 35.2284 16.3007 35.4334 12.4247 34.2581C8.54876 33.0827 5.20029 30.5996 2.94991 27.2321C0.699526 23.8645 -0.313502 19.8208 0.0834483 15.79C0.480399 11.7593 2.26276 7.99084 5.12682 5.12695C6.74942 3.49894 8.67793 2.20784 10.8014 1.32796C12.9248 0.448074 15.2013 -0.00323687 17.4999 -5.65968e-06ZM17.3888 21.1287L14.8395 28.1726C14.7769 28.3491 14.6796 28.5113 14.5534 28.6497C14.4272 28.7882 14.2747 28.9 14.1047 28.9787C13.8494 29.0984 13.5642 29.1396 13.2855 29.0971C13.0067 29.0546 12.7468 28.9303 12.5388 28.7399C12.3307 28.5496 12.1838 28.3017 12.1168 28.0278C12.0498 27.7539 12.0655 27.4663 12.1621 27.2013L13.9395 22.2795C14.0805 21.9091 14.192 21.5281 14.2727 21.1401C14.3446 20.7462 14.3959 20.3488 14.4265 19.9495C14.4949 19.2289 14.5433 18.4485 14.5804 17.6994C14.6174 16.9503 14.643 16.224 14.663 15.623C14.6886 14.8739 14.4864 14.8254 13.8854 14.683L13.76 14.6545L8.63308 13.689C8.44869 13.6564 8.27252 13.5879 8.11466 13.4872C7.95679 13.3865 7.82033 13.2557 7.71308 13.1022C7.55375 12.8697 7.467 12.5951 7.4638 12.3133C7.46061 12.0315 7.54111 11.755 7.69513 11.519C7.84915 11.2829 8.06975 11.0979 8.329 10.9872C8.58825 10.8766 8.87449 10.8454 9.15148 10.8976L14.6601 11.9316C14.8794 11.9515 15.093 11.9771 15.3181 12.0028C15.9959 12.0956 16.679 12.1461 17.3631 12.1537C18.2148 12.1371 19.0649 12.0734 19.9095 11.9629C20.1659 11.9344 20.408 11.9031 20.6501 11.8803L25.8483 10.9062C26.217 10.8297 26.6011 10.9024 26.9164 11.1084C27.0726 11.2141 27.2063 11.3499 27.3097 11.5077C27.4131 11.6655 27.484 11.8424 27.5185 12.0279C27.5529 12.2134 27.5502 12.4039 27.5104 12.5883C27.4706 12.7727 27.3945 12.9474 27.2866 13.1022C27.1809 13.2567 27.0456 13.3887 26.8888 13.4909C26.7319 13.593 26.5564 13.6632 26.3723 13.6975L21.4049 14.6317C21.2397 14.6688 21.0916 14.6944 20.9606 14.7143C20.4422 14.8026 20.1858 14.8482 20.2172 15.5859C20.2399 16.1243 20.3054 16.768 20.3909 17.4402C20.4906 18.2292 20.6216 19.0666 20.7583 19.8328C20.8466 20.3369 20.9292 20.7414 21.0432 21.1287C21.1571 21.5161 21.2682 21.912 21.4391 22.3877L23.1794 27.2013C23.276 27.4663 23.2918 27.7539 23.2247 28.0278C23.1577 28.3017 23.0108 28.5496 22.8028 28.7399C22.5947 28.9303 22.3348 29.0546 22.0561 29.0971C21.7773 29.1396 21.4922 29.0984 21.2368 28.9787C21.0669 28.9 20.9143 28.7882 20.7881 28.6497C20.6619 28.5113 20.5647 28.3491 20.502 28.1726L17.9442 21.143L17.6594 20.6217L17.3745 21.1287H17.3888ZM17.4999 5.8846C18.0818 5.8841 18.6458 6.0854 19.0959 6.45418C19.5461 6.82297 19.8544 7.33642 19.9683 7.90705C20.0823 8.47767 19.9949 9.07017 19.721 9.58356C19.4471 10.097 19.0036 10.4995 18.4662 10.7226C17.9287 10.9456 17.3306 10.9754 16.7736 10.8069C16.2166 10.6384 15.7353 10.2819 15.4117 9.79833C15.0881 9.31471 14.9422 8.73385 14.9989 8.15472C15.0556 7.57558 15.3113 7.03402 15.7225 6.62231C15.9555 6.38819 16.2324 6.20248 16.5375 6.07587C16.8425 5.94926 17.1696 5.88426 17.4999 5.8846ZM27.8535 7.1464C25.4612 4.74613 22.3106 3.24973 18.9386 2.91223C15.5666 2.57472 12.1819 3.417 9.36132 5.29552C6.54077 7.17404 4.45894 9.97254 3.47062 13.2141C2.4823 16.4556 2.64866 19.9396 3.94135 23.0722C5.23404 26.2048 7.57305 28.7922 10.5598 30.3934C13.5465 31.9946 16.996 32.5106 20.3205 31.8533C23.645 31.196 26.6387 29.4062 28.7914 26.7889C30.9441 24.1717 32.1225 20.8888 32.1259 17.5C32.1302 15.578 31.7549 13.674 31.0218 11.8973C30.2886 10.1206 29.2119 8.5061 27.8535 7.1464Z"
              fill="white" />
          </g>
          <defs>
            <clipPath id="clip0_38_32">
              <rect width="35" height="35" fill="white" />
            </clipPath>
          </defs>
        </svg>

      </button>
    </div>
    <canvas id="unity-canvas" tabindex="-1"></canvas>
    <div id="unity-loading-bar">
      <div id="unity-progress-bar-empty">
        <div id="unity-progress-bar-full"></div>
      </div>
    </div>
    <div id="unity-warning"> </div>
    <div id="unity-fullscreen-button"></div>
  </div>
  <script>
    //Used to enable and disable Accessibility Package in Unity so screen readers can read this button
    var unityInstance = null;
    const hasFullScreenButton = false;

    function enableAccessibilityInUnity() {
      if (unityInstance) {
        unityInstance.SendMessage('AccessibilityManager', 'WebToggleAccessibility');
      } else {
        console.log('Unity instance is not ready or not found.');
      }
    }
    function unityLoaded(instance) {
      unityInstance = instance;
    }
    let hasEnabledVoice = false;
    document.getElementById('accessibility-button').addEventListener('click', function () {
      enableAccessibilityInUnity();
      if (hasEnabledVoice) {
        return;
      }
      //This is necessary to enable screen reading on iOS devices.
      //Users must directly engages ths speach synthesis API through a button click before it can be used by code
      const lecture = new SpeechSynthesisUtterance('unheard audio');
      lecture.volume = 0;
      speechSynthesis.speak(lecture);
      hasEnabledVoice = true;
    });

    var container = document.querySelector("#unity-container");
    var canvas = document.querySelector("#unity-canvas");
    var accessibilityContainer = document.querySelector("#accessibility-container");
    var loadingBar = document.querySelector("#unity-loading-bar");
    var progressBarFull = document.querySelector("#unity-progress-bar-full");
    var warningBanner = document.querySelector("#unity-warning");
    var fullscreenButton = document.querySelector("#unity-fullscreen-button");
    fullscreenButton.style.display = hasFullScreenButton ? "block" : "none";
    var meta = document.createElement('meta');
    meta.name = 'viewport';
    meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
    document.getElementsByTagName('head')[0].appendChild(meta);

    function adjustContainerSize() {
      container.style.height = window.innerHeight + 'px';
    }

    window.addEventListener('resize', adjustContainerSize);
    window.addEventListener('orientationchange', adjustContainerSize);
    adjustContainerSize();

    function adjustCanvasSize() {
      const targetWidth = window.innerWidth;
      const targetHeight = window.innerHeight;
      const currentAspectRatio = targetWidth / targetHeight;
      const minAspectRatio = 4 / 3; // Minimum aspect ratio
      const maxAspectRatio = 18 / 9; // Maximum aspect ratio
      let newWidth, newHeight;

      if (currentAspectRatio < minAspectRatio) {
        // If current aspect ratio is less than the minimum, fix to 4:3
        if (targetHeight * minAspectRatio <= targetWidth) {
          newHeight = targetHeight;
          newWidth = targetHeight * minAspectRatio;
        } else {
          newWidth = targetWidth;
          newHeight = targetWidth / minAspectRatio;
        }
      } else if (currentAspectRatio > maxAspectRatio) {
        // If current aspect ratio is greater than the maximum, fix to 21:9
        if (targetHeight * maxAspectRatio <= targetWidth) {
          newHeight = targetHeight;
          newWidth = targetHeight * maxAspectRatio;
        } else {
          newWidth = targetWidth;
          newHeight = targetWidth / maxAspectRatio;
        }
      } else {
        // If current aspect ratio is within the range, no need to adjust
        newWidth = targetWidth;
        newHeight = targetHeight;
      }

      canvas.style.width = newWidth + 'px';
      canvas.style.height = newHeight + 'px';
      accessibilityContainer.style.width = newWidth + 'px';
      accessibilityContainer.style.height = newHeight + 'px';
    }

    window.addEventListener('resize', adjustCanvasSize);
    window.addEventListener('orientationchange', adjustCanvasSize);
    adjustCanvasSize(); // Initial adjustment

    var gl = document.createElement("canvas").getContext("webgl");
    var gl2 = document.createElement("canvas").getContext("webgl2");
    console.info('WebGL2:', gl2 ? 'supported' : 'unsupported');

    var dataFile = "/{{{ DATA_FILENAME }}}";
    if (gl2) {
      var hasASTC = (gl && gl.getExtension('WEBGL_compressed_texture_astc')) || (gl2 && gl2.getExtension('WEBGL_compressed_texture_astc'));
      console.info('Texture version: ' + (hasASTC ? 'ASTC/mobile' : 'DXT/desktop'));
      if (hasASTC) {
        dataFile = dataFile.replace("_Build", "_Mobile");
      }
    } else {
      // WebGL2 is not supported, inform the user
      alert('Sorry, your browser does not support WebGL2 which is required for this application to run.', 'error');
    }
    const buildUrl = "Build";
    const loaderUrl = buildUrl + "/{{{ LOADER_FILENAME }}}";
    const config = {
      dataUrl: buildUrl + dataFile,
      frameworkUrl: buildUrl + "/{{{ FRAMEWORK_FILENAME }}}",
      codeUrl: buildUrl + "/{{{ CODE_FILENAME }}}",
      streamingAssetsUrl: "StreamingAssets",
      companyName: "{{{ COMPANY_NAME }}}",
      productName: "{{{ PRODUCT_NAME }}}",
      productVersion: "{{{ PRODUCT_VERSION }}}",
    };

    loadingBar.style.display = "block";

    var script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
      createUnityInstance(canvas, config, (progress) => {
        progressBarFull.style.width = 100 * progress + "%";
      }).then((unityInstance) => {
        loadingBar.style.display = "none"
        unityLoaded(unityInstance);
        fullscreenButton.onclick = () => {
          unityInstance.SetFullscreen(1);
        };
      }).catch((message) => {
        alert(message);
      });
    };
    document.body.appendChild(script);
  </script>
</body>

</html>